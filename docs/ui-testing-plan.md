# План UI-тестов (золотая середина)

## Цель
Защитить ключевые экраны от регрессий верстки и базовой работоспособности, не раздувая тестовый набор.

## Подход (рекомендованный)
- Визуальные снапшоты 5–7 ключевых экранов в двух вьюпортах:
  - Mobile: iPhone SE 2022 (375×667)
  - Desktop: 1280×800
- Один smoke-сценарий: import → открытие экранов → фильтры/поиск → export.
- Фиксированный набор данных (fixture JSON) для стабильных скринов.
- Отключение анимаций/переходов в тестовом окружении.

## Набор экранов для снапшотов
1. Дашборд
2. Транзакции (список)
3. Форма транзакции (новая)
4. Счета
5. Категории
6. Настройки (экспорт/импорт)
7. (опционально) Пустые состояния: dashboard/transactions

## Smoke-сценарий (основной)
1. Импортировать fixture JSON.
2. Открыть дашборд, список транзакций, счета, категории, настройки.
3. На транзакциях:
   - применить фильтр по счету
   - применить фильтр по категории
   - поиск по заметке
4. Экспортировать JSON и убедиться, что файл создается.

## Фикстуры данных
- Один минимальный набор (2 счета, 6–8 транзакций, 5–6 категорий).
- Один «плотный» набор (20+ транзакций, разные даты/категории).
- Фикстуры должны быть детерминированы (стабильные id и даты).

## Технические решения (ориентир)
- Инструмент: Playwright (визуальные снапшоты + smoke).
- Блокировка анимаций:
  - глобально в тестовой сборке через CSS:
    - `*, *::before, *::after { transition: none !important; animation: none !important; }`
- Скриншоты сохранять с фиксированным шрифтом и масштабом.

## Критерии прохождения
- Все визуальные снапшоты совпадают.
- Smoke-сценарий проходит без ошибок.
- Все ключевые страницы открываются и содержат основные элементы.

## Стартовый объём (первый этап)
- 6 визуальных снапшотов (dashboard/transactions/form/accounts/categories/settings) × 2 вьюпорта.
- 1 smoke-сценарий.

## Поддержка и регламент
- Запускать перед релизом и после изменений в UI/стилях.
- При редизайне: обновлять baseline снимки в рамках одной задачи.

## План задач (1–2 часа каждая)
- [ ] t1: Подготовить ветку/контекст для UI-тестов.
  - Описание: убедиться, что локально проект запускается и тесты доступны. Прочитать этот план и понять целевые экраны. Зафиксировать список экранов в заметках задачи.
- [ ] t2: Выбрать и зафиксировать вьюпорты.
  - Описание: записать точные размеры (375×667 и 1280×800) в конфиг тестов и в README для тестов, чтобы все работали с одинаковыми настройками.
- [ ] t3: Подготовить fixture JSON (минимальный).
  - Описание: создать стабильный JSON с 2 счетами, 5–6 категориями и 6–8 транзакциями. ID и даты должны быть фиксированными, без генерации на лету.
- [ ] t4: Подготовить fixture JSON (плотный).
  - Описание: создать второй JSON с 20+ транзакциями, разными датами и категориями для проверки плотной верстки списков.
- [ ] t5: Добавить helper для загрузки fixture.
  - Описание: написать утилиту/хелпер, который импортирует JSON через существующий механизм импорта (без обходных путей). Использовать его в тестах.
- [ ] t6: Добавить отключение анимаций в тестовой среде.
  - Описание: добавить CSS/инициализацию в тестах, чтобы скриншоты не "плавали". Проверить, что анимации реально отключены.
- [ ] t7: Написать smoke-сценарий.
  - Описание: один тест, который импортирует fixture, открывает ключевые страницы, применяет фильтр/поиск на транзакциях и делает экспорт.
- [ ] t8: Сделать визуальные снапшоты: dashboard.
  - Описание: скриншоты в двух вьюпортах, проверка основного блока балансов и списка счетов.
- [ ] t9: Сделать визуальные снапшоты: transactions list.
  - Описание: скриншоты в двух вьюпортах, проверка фильтров и списка транзакций.
- [ ] t10: Сделать визуальные снапшоты: transaction form.
  - Описание: скриншоты в двух вьюпортах, проверка поля суммы, селектов и даты.
- [ ] t11: Сделать визуальные снапшоты: accounts.
  - Описание: скриншоты в двух вьюпортах, проверка списка и кнопок.
- [ ] t12: Сделать визуальные снапшоты: categories.
  - Описание: скриншоты в двух вьюпортах, проверка списка и статусов.
- [ ] t13: Сделать визуальные снапшоты: settings.
  - Описание: скриншоты в двух вьюпортах, проверка блока экспорта/импорта.
- [ ] t14: Проверить пустые состояния (опционально).
  - Описание: отдельный набор скриншотов на пустых данных для dashboard/transactions.
- [ ] t15: Документировать запуск тестов.
  - Описание: добавить краткие команды запуска и правила обновления baseline в README тестов.
